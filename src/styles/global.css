@import "tailwindcss";

/* Class-based dark mode for Tailwind 4 */
@custom-variant dark (&:where(.dark, .dark *));

/* --- Color System & Base Styles --- */
@layer base {
  :root {
    --color-text: #111827;
    --color-text-secondary: #4B5563;
    --color-text-muted: #535D6B;
    --color-accent: #2563EB;
    --color-accent-hover: #1D4ED8;
    --color-bg: #FFFFFF;
    --color-bg-subtle: #F8FAFC;
    --color-border: #E5E7EB;

    --font-display: 'Bricolage Grotesque', sans-serif;
    --font-sans: 'Inter', system-ui, sans-serif;
    --font-mono: 'JetBrains Mono', monospace;
  }

  .dark {
    --color-text: #F1F5F9;
    --color-text-secondary: #94A3B8;
    --color-text-muted: #64748B;
    --color-accent: #60A5FA;
    --color-accent-hover: #93C5FD;
    --color-bg: #0F172A;
    --color-bg-subtle: #1E293B;
    --color-border: #334155;
  }

  body {
    font-family: var(--font-sans);
    color: var(--color-text);
    background-color: var(--color-bg);
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  h1, h2, h3 {
    font-family: var(--font-display);
    font-weight: 800;
    color: var(--color-accent);
    text-wrap: balance;
  }

  code, pre, kbd {
    font-family: var(--font-mono);
  }

  :focus-visible {
    outline: 3px solid var(--color-accent);
    outline-offset: 2px;
  }

  :focus:not(:focus-visible) {
    outline: none;
  }
}

/* --- Components --- */
@layer components {
  /* Scroll reveals â€” gated behind .js-ready for progressive enhancement */
  .js-ready {
    .reveal {
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;

      &.revealed {
        opacity: 1;
        transform: translateY(0);
      }
    }
  }

  /* Skip to content */
  .skip-to-content {
    position: absolute;
    inset-block-start: -100%;
    inset-inline-start: 16px;
    z-index: 100;
    padding-block: 8px;
    padding-inline: 16px;
    background: var(--color-accent);
    color: #FFFFFF;
    border-radius: 0 0 8px 8px;
    font-weight: 600;
    text-decoration: none;
    transition: inset-block-start 0.2s ease;

    &:focus {
      inset-block-start: 0;
    }
  }

  /* Nav scroll state */
  #site-nav {
    transition: background-color 0.3s ease, backdrop-filter 0.3s ease, border-color 0.3s ease;
    border-bottom: 1px solid transparent;

    &.scrolled {
      background-color: color-mix(in srgb, var(--color-bg) 80%, transparent);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom-color: var(--color-border);
    }
  }

  /* Copy sparkle animation */
  @keyframes sparkle-burst {
    0% {
      opacity: 1;
      transform: translate(0, 0) scale(1);
    }
    100% {
      opacity: 0;
      transform: translate(var(--sparkle-x), var(--sparkle-y)) scale(0.5);
    }
  }

  .sparkle-dot {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: var(--color-accent);
    pointer-events: none;
    animation: sparkle-burst 0.4s ease-out forwards;
  }

  /* Custom cursor */
  @media (pointer: fine) and (min-width: 1024px) {
    .custom-cursor-enabled {
      cursor: none;

      * {
        cursor: none;
      }
    }
  }

  .cursor-dot {
    position: fixed;
    inset-block-start: 0;
    inset-inline-start: 0;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--color-accent);
    pointer-events: none;
    z-index: 9999;
    transform: translate(-50%, -50%);
    transition: width 0.2s ease, height 0.2s ease, background 0.2s ease;
    mix-blend-mode: normal;
    will-change: transform;

    &.hovering {
      width: 40px;
      height: 40px;
      mix-blend-mode: difference;
      background: #FFFFFF;
    }
  }

  @media (pointer: coarse), (max-width: 1023px) {
    .cursor-dot {
      display: none !important;
    }
  }

  /* Screenshot parallax */
  [data-parallax] {
    will-change: transform;

    img {
      transition: transform 0.15s ease-out;
    }
  }
}

/* --- Reduced Motion (unlayered to override all layers) --- */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .reveal {
    opacity: 1;
    transform: none;
  }

  .cursor-dot {
    display: none !important;
  }

  .custom-cursor-enabled {
    cursor: auto !important;

    * {
      cursor: auto !important;
    }
  }
}
